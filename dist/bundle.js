(()=>{"use strict";class e{constructor(e,t,n,r){this.templateElemetn=document.getElementById(e),this.hostElement=document.getElementById(t);const s=document.importNode(this.templateElemetn.content,!0);this.element=s.firstElementChild,r&&(this.element.id=r),this.attach(n)}attach(e){this.hostElement.insertAdjacentElement(e?"afterbegin":"beforeend",this.element)}}function t(e,t,n){const r=n.value;return{configurable:!0,get(){return r.bind(this)}}}function n(e){let t=!0;return e.required&&(t=t&&0!=e.value.toString().trim().length),null!=e.minLength&&"string"==typeof e.value&&(t=t&&e.value.length>=e.minLength),null!=e.maxLength&&"string"==typeof e.value&&(t=t&&e.value.length<=e.maxLength),null!=e.min&&"number"==typeof e.value&&(t=t&&e.value>=e.min),null!=e.max&&"number"==typeof e.value&&(t=t&&e.value<=e.max),t}var r;!function(e){e[e.Active=0]="Active",e[e.Finished=1]="Finished"}(r||(r={}));class s{constructor(e,t,n,r,s){this.id=e,this.title=t,this.description=n,this.people=r,this.status=s}}class i{constructor(){this.listeners=[]}addListener(e){this.listeners.push(e)}}class l extends i{constructor(){super(),this.projects=[]}static getInstance(){return this.instance||(this.instance=new l),this.instance}addProject(e,t,n){const i=new s(Math.random().toString(),e,t,n,r.Active);this.projects.push(i),this.updateListeners()}moveProject(e,t){const n=this.projects.find((t=>t.id===e));n&&n.status!==t&&(n.status=t,this.updateListeners())}updateListeners(){for(const e of this.listeners)e(this.projects.slice())}}const o=l.getInstance();class a extends e{constructor(){super("project-input","app",!0,"user-input"),this.titleInputElement=this.element.querySelector("#title"),this.descriptionInputElement=this.element.querySelector("#description"),this.peopleInputElement=this.element.querySelector("#people"),this.configure()}configure(){this.element.addEventListener("submit",this.submitHandler)}renderContent(){}gatherUserInput(){const e=this.titleInputElement.value,t=this.descriptionInputElement.value,r=this.peopleInputElement.value,s={value:t,required:!0,minLength:5},i={value:+r,required:!0,min:1,max:5};return n({value:e,required:!0})&&n(s)&&n(i)?[e,t,+r]:void alert("Invalid input, please try again!")}clearInputs(){this.titleInputElement.value="",this.descriptionInputElement.value="",this.peopleInputElement.value=""}submitHandler(e){e.preventDefault();const t=this.gatherUserInput();if(Array.isArray(t)){const[e,n,r]=t;o.addProject(e,n,r),this.clearInputs()}}}!function(e,t,n,r){var s,i=arguments.length,l=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(l=(i<3?s(l):i>3?s(t,n,l):s(t,n))||l);i>3&&l&&Object.defineProperty(t,n,l)}([t],a.prototype,"submitHandler",null);class c extends e{get persons(){return 1===this.project.people?"1 person":`${this.project.people} persons`}constructor(e,t){super("single-project",e,!1,t.id),this.project=t,this.configure(),this.renderContent()}dragStartHandler(e){e.dataTransfer.setData("text/plain",this.project.id),e.dataTransfer.effectAllowed="move"}dragEndHandler(e){console.log("DragEnd")}configure(){this.element.addEventListener("dragstart",this.dragStartHandler),this.element.addEventListener("dragend",this.dragEndHandler)}renderContent(){this.element.querySelector("h2").textContent=this.project.title,this.element.querySelector("h3").textContent=this.persons+" assigned",this.element.querySelector("p").textContent=this.project.description}}!function(e,t,n,r){var s,i=arguments.length,l=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(l=(i<3?s(l):i>3?s(t,n,l):s(t,n))||l);i>3&&l&&Object.defineProperty(t,n,l)}([t],c.prototype,"dragStartHandler",null);var d=function(e,t,n,r){var s,i=arguments.length,l=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(l=(i<3?s(l):i>3?s(t,n,l):s(t,n))||l);return i>3&&l&&Object.defineProperty(t,n,l),l};class p extends e{constructor(e){super("project-list","app",!1,`${e}-projects`),this.type=e,this.assignedProjects=[],this.configure(),this.renderContent()}dragOverHandler(e){e.dataTransfer&&"text/plain"===e.dataTransfer.types[0]&&(e.preventDefault(),this.element.querySelector("ul").classList.add("droppable"))}dropHandler(e){const t=e.dataTransfer.getData("text/plain");o.moveProject(t,"active"===this.type?r.Active:r.Finished)}dragLeaveHandler(e){this.element.querySelector("ul").classList.remove("droppable")}configure(){this.element.addEventListener("dragover",this.dragOverHandler),this.element.addEventListener("dragleave",this.dragLeaveHandler),this.element.addEventListener("drop",this.dropHandler),o.addListener((e=>{const t=e.filter((e=>"active"===this.type?e.status===r.Active:e.status===r.Finished));this.assignedProjects=t,this.renderProjects()}))}renderContent(){const e=`${this.type}-projects-list`;this.element.querySelector("ul").id=e,this.element.querySelector("h2").textContent=this.type.toUpperCase()+" PROJECTS"}renderProjects(){document.getElementById(`${this.type}-projects-list`).innerHTML="";for(const e of this.assignedProjects)new c(this.element.querySelector("ul").id,e)}}d([t],p.prototype,"dragOverHandler",null),d([t],p.prototype,"dropHandler",null),d([t],p.prototype,"dragLeaveHandler",null),new a;const u=document.getElementById("active-finished-projects"),h=new p("active"),m=new p("finished");u.appendChild(h.element),u.appendChild(m.element)})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RUFFSixNQUFNc0QsRUFBdUJySCxTQUFTQyxlQUFlLDRCQUUvQ3FILEVBQWdCLElBQUlyQixFQUFZLFVBQ2hDc0IsRUFBa0IsSUFBSXRCLEVBQVksWUFFeENvQixFQUFxQkcsWUFBWUYsRUFBY2hILFNBQy9DK0csRUFBcUJHLFlBQVlELEVBQWdCakgsUSIsInNvdXJjZXMiOlsid2VicGFjazovL3VkZW15Ly4vc3JjL2NvbXBvbmVudHMvYmFzZS1jb21wb25lbnQudHMiLCJ3ZWJwYWNrOi8vdWRlbXkvLi9zcmMvZGVjb3JhdG9ycy9hdXRvYmluZC50cyIsIndlYnBhY2s6Ly91ZGVteS8uL3NyYy91dGlsL3ZhbGlkYXRpb24udHMiLCJ3ZWJwYWNrOi8vdWRlbXkvLi9zcmMvbW9kZWxzL3Byb2plY3QudHMiLCJ3ZWJwYWNrOi8vdWRlbXkvLi9zcmMvc3RhdGUvcHJvamVjdC1zdGF0ZS50cyIsIndlYnBhY2s6Ly91ZGVteS8uL3NyYy9jb21wb25lbnRzL3Byb2plY3QtaW5wdXQudHMiLCJ3ZWJwYWNrOi8vdWRlbXkvLi9zcmMvY29tcG9uZW50cy9wcm9qZWN0LWl0ZW0udHMiLCJ3ZWJwYWNrOi8vdWRlbXkvLi9zcmMvY29tcG9uZW50cy9wcm9qZWN0LWxpc3QudHMiLCJ3ZWJwYWNrOi8vdWRlbXkvLi9zcmMvYXBwLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIiAgICBleHBvcnQgYWJzdHJhY3QgY2xhc3MgQ29tcG9uZW50PFQgZXh0ZW5kcyBIVE1MRWxlbWVudCwgVSBleHRlbmRzIEhUTUxFbGVtZW50PntcclxuICAgICAgICB0ZW1wbGF0ZUVsZW1ldG46IEhUTUxUZW1wbGF0ZUVsZW1lbnQ7XHJcbiAgICAgICAgaG9zdEVsZW1lbnQ6IFQ7XHJcbiAgICAgICAgZWxlbWVudDogVTtcclxuXHJcbiAgICAgICAgY29uc3RydWN0b3IoXHJcbiAgICAgICAgICAgIHRlbXBsYXRlZElkOiBzdHJpbmcsXHJcbiAgICAgICAgICAgIGhvc3RFbGVtZW50SWQ6IHN0cmluZyxcclxuICAgICAgICAgICAgaW5zZXJ0QXRTdGFydDogYm9vbGVhbixcclxuICAgICAgICAgICAgbmV3RWxlbWVudElkPzogc3RyaW5nIFxyXG4gICAgICAgICkge1xyXG4gICAgICAgICAgICB0aGlzLnRlbXBsYXRlRWxlbWV0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFxyXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVkSWRcclxuICAgICAgICAgICAgKSEgYXMgSFRNTFRlbXBsYXRlRWxlbWVudDtcclxuICAgICAgICAgICAgdGhpcy5ob3N0RWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGhvc3RFbGVtZW50SWQpISBhcyBUO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgaW1wb3J0ZWROb2RlID0gZG9jdW1lbnQuaW1wb3J0Tm9kZShcclxuICAgICAgICAgICAgICAgIHRoaXMudGVtcGxhdGVFbGVtZXRuLmNvbnRlbnQsXHJcbiAgICAgICAgICAgICAgICB0cnVlXHJcbiAgICAgICAgICAgIClcclxuICAgICAgICAgICAgdGhpcy5lbGVtZW50ID0gaW1wb3J0ZWROb2RlLmZpcnN0RWxlbWVudENoaWxkIGFzIFU7XHJcbiAgICAgICAgICAgIGlmIChuZXdFbGVtZW50SWQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZWxlbWVudC5pZCA9IG5ld0VsZW1lbnRJZDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLmF0dGFjaChpbnNlcnRBdFN0YXJ0KVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHJpdmF0ZSBhdHRhY2goaW5zZXJ0QXRCZWdpbm5pbmc6IGJvb2xlYW4pIHtcclxuICAgICAgICAgICAgdGhpcy5ob3N0RWxlbWVudC5pbnNlcnRBZGphY2VudEVsZW1lbnQoaW5zZXJ0QXRCZWdpbm5pbmcgPyAnYWZ0ZXJiZWdpbicgOiAnYmVmb3JlZW5kJywgdGhpcy5lbGVtZW50KVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgYWJzdHJhY3QgY29uZmlndXJlKCk6IHZvaWQ7XHJcbiAgICAgICAgYWJzdHJhY3QgcmVuZGVyQ29udGVudCgpOiB2b2lkO1xyXG4gICAgfVxyXG4iLCIgICAgZXhwb3J0IGZ1bmN0aW9uIGF1dG9iaW5kKF86IGFueSwgXzI6IHN0cmluZywgZGVzY3JpcHRvcjogUHJvcGVydHlEZXNjcmlwdG9yKSB7XHJcbiAgICAgICAgY29uc3Qgb3JpZ2luYWxNZXRob2QgPSBkZXNjcmlwdG9yLnZhbHVlO1xyXG4gICAgICAgIGNvbnN0IGFkakRlc2NyaXB0b3I6IFByb3BlcnR5RGVzY3JpcHRvciA9IHtcclxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxyXG4gICAgICAgICAgICBnZXQoKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBib3VuZEZuID0gb3JpZ2luYWxNZXRob2QuYmluZCh0aGlzKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBib3VuZEZuXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGFkakRlc2NyaXB0b3JcclxuICAgIH1cclxuIiwiICAgIGV4cG9ydCBpbnRlcmZhY2UgVmFsaWRhdGFibGV7XHJcbiAgICAgICAgdmFsdWU6IHN0cmluZyB8IG51bWJlcjtcclxuICAgICAgICByZXF1aXJlZD86IGJvb2xlYW47XHJcbiAgICAgICAgbWluTGVuZ3RoPzogbnVtYmVyO1xyXG4gICAgICAgIG1heExlbmd0aD86IG51bWJlcjtcclxuICAgICAgICBtaW4/OiBudW1iZXI7XHJcbiAgICAgICAgbWF4PzogbnVtYmVyO1xyXG4gICAgfVxyXG5cclxuICAgIGV4cG9ydCBmdW5jdGlvbiB2YWxpZGF0ZSh2YWxpZGF0YWJsZUlucHV0OiBWYWxpZGF0YWJsZSkge1xyXG4gICAgICAgIGxldCBpc1ZhbGlkID0gdHJ1ZTtcclxuICAgICAgICBpZiAodmFsaWRhdGFibGVJbnB1dC5yZXF1aXJlZCkge1xyXG4gICAgICAgICAgICBpc1ZhbGlkID0gaXNWYWxpZCAmJiB2YWxpZGF0YWJsZUlucHV0LnZhbHVlLnRvU3RyaW5nKCkudHJpbSgpLmxlbmd0aCAhPSAwXHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChcclxuICAgICAgICAgICAgdmFsaWRhdGFibGVJbnB1dC5taW5MZW5ndGggIT0gbnVsbCAmJlxyXG4gICAgICAgICAgICB0eXBlb2YgdmFsaWRhdGFibGVJbnB1dC52YWx1ZSA9PT0gJ3N0cmluZycgXHJcbiAgICAgICAgKSB7XHJcbiAgICAgICAgICAgIGlzVmFsaWQgPSBpc1ZhbGlkICYmIHZhbGlkYXRhYmxlSW5wdXQudmFsdWUubGVuZ3RoID49IHZhbGlkYXRhYmxlSW5wdXQubWluTGVuZ3RoXHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChcclxuICAgICAgICAgICAgdmFsaWRhdGFibGVJbnB1dC5tYXhMZW5ndGggIT0gbnVsbCAmJlxyXG4gICAgICAgICAgICB0eXBlb2YgdmFsaWRhdGFibGVJbnB1dC52YWx1ZSA9PT0gJ3N0cmluZycgXHJcbiAgICAgICAgKSB7XHJcbiAgICAgICAgICAgIGlzVmFsaWQgPSBpc1ZhbGlkICYmIHZhbGlkYXRhYmxlSW5wdXQudmFsdWUubGVuZ3RoIDw9IHZhbGlkYXRhYmxlSW5wdXQubWF4TGVuZ3RoXHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChcclxuICAgICAgICAgICAgdmFsaWRhdGFibGVJbnB1dC5taW4gIT0gbnVsbCAmJlxyXG4gICAgICAgICAgICB0eXBlb2YgdmFsaWRhdGFibGVJbnB1dC52YWx1ZSA9PT0gJ251bWJlcidcclxuICAgICAgICApIHtcclxuICAgICAgICAgICAgaXNWYWxpZCA9IGlzVmFsaWQgJiYgdmFsaWRhdGFibGVJbnB1dC52YWx1ZSA+PSB2YWxpZGF0YWJsZUlucHV0Lm1pblxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoXHJcbiAgICAgICAgICAgIHZhbGlkYXRhYmxlSW5wdXQubWF4ICE9IG51bGwgJiZcclxuICAgICAgICAgICAgdHlwZW9mIHZhbGlkYXRhYmxlSW5wdXQudmFsdWUgPT09ICdudW1iZXInXHJcbiAgICAgICAgKSB7XHJcbiAgICAgICAgICAgIGlzVmFsaWQgPSBpc1ZhbGlkICYmIHZhbGlkYXRhYmxlSW5wdXQudmFsdWUgPD0gdmFsaWRhdGFibGVJbnB1dC5tYXhcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGlzVmFsaWRcclxuICAgIH1cclxuIiwiICAgIGV4cG9ydCBlbnVtIFByb2plY3RTdGF0dXN7XHJcbiAgICAgICAgQWN0aXZlLFxyXG4gICAgICAgIEZpbmlzaGVkXHJcbiAgICB9XHJcblxyXG4gICAgZXhwb3J0IGNsYXNzIFByb2plY3R7XHJcbiAgICAgICAgY29uc3RydWN0b3IoXHJcbiAgICAgICAgcHVibGljIGlkOiBzdHJpbmcsXHJcbiAgICAgICAgcHVibGljIHRpdGxlOiBzdHJpbmcsXHJcbiAgICAgICAgcHVibGljIGRlc2NyaXB0aW9uOiBzdHJpbmcsXHJcbiAgICAgICAgcHVibGljIHBlb3BsZTogbnVtYmVyLFxyXG4gICAgICAgIHB1YmxpYyBzdGF0dXM6IFByb2plY3RTdGF0dXNcclxuICAgICAgICApIHt9XHJcbiAgICB9XHJcbiIsImltcG9ydCB7IFByb2plY3QsIFByb2plY3RTdGF0dXMgfSBmcm9tICcuLi9tb2RlbHMvcHJvamVjdCc7XHJcblxyXG4gICAgdHlwZSBMaXN0bmVyPFQ+ID0gKGl0ZW1zOiBUW10pID0+IHZvaWRcclxuXHJcbiAgICBjbGFzcyBTdGF0ZTxUPiB7XHJcbiAgICAgICAgcHJvdGVjdGVkIGxpc3RlbmVyczogTGlzdG5lcjxUPltdID0gW11cclxuICAgICAgICBcclxuICAgICAgICBhZGRMaXN0ZW5lcihsaXN0ZW5lckZuOiBMaXN0bmVyPFQ+KSB7XHJcbiAgICAgICAgICAgIHRoaXMubGlzdGVuZXJzLnB1c2gobGlzdGVuZXJGbilcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZXhwb3J0IGNsYXNzIFByb2plY3RTdGF0ZSBleHRlbmRzIFN0YXRlPFByb2plY3Q+e1xyXG4gICAgICAgIHByaXZhdGUgcHJvamVjdHM6IFByb2plY3RbXSA9IFtdO1xyXG4gICAgICAgIHByaXZhdGUgc3RhdGljIGluc3RhbmNlOiBQcm9qZWN0U3RhdGU7XHJcblxyXG4gICAgICAgIHByaXZhdGUgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgICAgIHN1cGVyKClcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHN0YXRpYyBnZXRJbnN0YW5jZSgpIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuaW5zdGFuY2UpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmluc3RhbmNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuaW5zdGFuY2UgPSBuZXcgUHJvamVjdFN0YXRlKClcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuaW5zdGFuY2U7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBhZGRQcm9qZWN0KHRpdGxlOiBzdHJpbmcsIGRlc2NyaXB0aW9uOiBzdHJpbmcsIG51bU9mUGVvcGxlOiBudW1iZXIpIHtcclxuICAgICAgICAgICAgY29uc3QgbmV3UHJvamVjdCA9IG5ldyBQcm9qZWN0KFxyXG4gICAgICAgICAgICAgICAgTWF0aC5yYW5kb20oKS50b1N0cmluZygpLFxyXG4gICAgICAgICAgICAgICAgdGl0bGUsXHJcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgIG51bU9mUGVvcGxlLFxyXG4gICAgICAgICAgICAgICAgUHJvamVjdFN0YXR1cy5BY3RpdmVcclxuICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICB0aGlzLnByb2plY3RzLnB1c2gobmV3UHJvamVjdClcclxuICAgICAgICAgICAgdGhpcy51cGRhdGVMaXN0ZW5lcnMoKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbW92ZVByb2plY3QocHJvamVjdElkOiBzdHJpbmcsIG5ld1N0YXR1czogUHJvamVjdFN0YXR1cykge1xyXG4gICAgICAgICAgICBjb25zdCBwcm9qZWN0ID0gdGhpcy5wcm9qZWN0cy5maW5kKHByaiA9PiBwcmouaWQgPT09IHByb2plY3RJZClcclxuICAgICAgICAgICAgaWYgKHByb2plY3QgJiYgcHJvamVjdC5zdGF0dXMgIT09IG5ld1N0YXR1cykge1xyXG4gICAgICAgICAgICAgICAgcHJvamVjdC5zdGF0dXMgPSBuZXdTdGF0dXNcclxuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlTGlzdGVuZXJzKClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHJpdmF0ZSB1cGRhdGVMaXN0ZW5lcnMoKSB7XHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgbGlzdGVuZXJGbiBvZiB0aGlzLmxpc3RlbmVycykge1xyXG4gICAgICAgICAgICAgICAgbGlzdGVuZXJGbih0aGlzLnByb2plY3RzLnNsaWNlKCkpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZXhwb3J0IGNvbnN0IHByb2plY3RTdGF0ZSA9IFByb2plY3RTdGF0ZS5nZXRJbnN0YW5jZSgpXHJcblxyXG4iLCJpbXBvcnQgeyBDb21wb25lbnQgfSBmcm9tICcuL2Jhc2UtY29tcG9uZW50J1xyXG5pbXBvcnQgeyBhdXRvYmluZCB9IGZyb20gJy4uL2RlY29yYXRvcnMvYXV0b2JpbmQnO1xyXG5pbXBvcnQgeyBWYWxpZGF0YWJsZSwgdmFsaWRhdGUgfSBmcm9tICcuLi91dGlsL3ZhbGlkYXRpb24nO1xyXG5pbXBvcnQgeyBwcm9qZWN0U3RhdGUgfSBmcm9tICcuLi9zdGF0ZS9wcm9qZWN0LXN0YXRlJztcclxuXHJcbiAgICBleHBvcnQgY2xhc3MgUHJvamVjdElucHV0IGV4dGVuZHMgQ29tcG9uZW50PEhUTUxEaXZFbGVtZW50LCBIVE1MRm9ybUVsZW1lbnQ+e1xyXG4gICAgICAgIHRpdGxlSW5wdXRFbGVtZW50OiBIVE1MSW5wdXRFbGVtZW50O1xyXG4gICAgICAgIGRlc2NyaXB0aW9uSW5wdXRFbGVtZW50OiBIVE1MSW5wdXRFbGVtZW50O1xyXG4gICAgICAgIHBlb3BsZUlucHV0RWxlbWVudDogSFRNTElucHV0RWxlbWVudDtcclxuXHJcbiAgICAgICAgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgc3VwZXIoJ3Byb2plY3QtaW5wdXQnLCAnYXBwJywgdHJ1ZSwgJ3VzZXItaW5wdXQnKTtcclxuICAgICAgICB0aGlzLnRpdGxlSW5wdXRFbGVtZW50ID0gdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgICAgJyN0aXRsZSdcclxuICAgICAgICApIGFzIEhUTUxJbnB1dEVsZW1lbnQ7XHJcbiAgICAgICAgdGhpcy5kZXNjcmlwdGlvbklucHV0RWxlbWVudCA9IHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICAgICcjZGVzY3JpcHRpb24nXHJcbiAgICAgICAgKSBhcyBIVE1MSW5wdXRFbGVtZW50O1xyXG4gICAgICAgIHRoaXMucGVvcGxlSW5wdXRFbGVtZW50ID0gdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgICAgJyNwZW9wbGUnXHJcbiAgICAgICAgKSBhcyBIVE1MSW5wdXRFbGVtZW50O1xyXG4gICAgICAgIHRoaXMuY29uZmlndXJlKCk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uZmlndXJlKCkge1xyXG4gICAgICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCB0aGlzLnN1Ym1pdEhhbmRsZXIpO1xyXG4gICAgfVxyXG5cclxuICAgIHJlbmRlckNvbnRlbnQoKSB7fVxyXG5cclxuICAgIHByaXZhdGUgZ2F0aGVyVXNlcklucHV0KCk6IFtzdHJpbmcsIHN0cmluZywgbnVtYmVyXSB8IHZvaWQge1xyXG4gICAgICAgIGNvbnN0IGVudGVyZWRUaXRsZSA9IHRoaXMudGl0bGVJbnB1dEVsZW1lbnQudmFsdWU7XHJcbiAgICAgICAgY29uc3QgZW50ZXJlZERlc2NyaXB0aW9uID0gdGhpcy5kZXNjcmlwdGlvbklucHV0RWxlbWVudC52YWx1ZTtcclxuICAgICAgICBjb25zdCBlbnRlcmVkUGVvcGxlID0gdGhpcy5wZW9wbGVJbnB1dEVsZW1lbnQudmFsdWU7XHJcblxyXG4gICAgICAgIGNvbnN0IHRpdGxlVmFsaWRhdGFibGU6IFZhbGlkYXRhYmxlID0ge1xyXG4gICAgICAgIHZhbHVlOiBlbnRlcmVkVGl0bGUsXHJcbiAgICAgICAgcmVxdWlyZWQ6IHRydWVcclxuICAgICAgICB9O1xyXG4gICAgICAgIGNvbnN0IGRlc2NyaXB0aW9uVmFsaWRhdGFibGU6IFZhbGlkYXRhYmxlID0ge1xyXG4gICAgICAgIHZhbHVlOiBlbnRlcmVkRGVzY3JpcHRpb24sXHJcbiAgICAgICAgcmVxdWlyZWQ6IHRydWUsXHJcbiAgICAgICAgbWluTGVuZ3RoOiA1XHJcbiAgICAgICAgfTtcclxuICAgICAgICBjb25zdCBwZW9wbGVWYWxpZGF0YWJsZTogVmFsaWRhdGFibGUgPSB7XHJcbiAgICAgICAgdmFsdWU6ICtlbnRlcmVkUGVvcGxlLFxyXG4gICAgICAgIHJlcXVpcmVkOiB0cnVlLFxyXG4gICAgICAgIG1pbjogMSxcclxuICAgICAgICBtYXg6IDVcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICBpZiAoXHJcbiAgICAgICAgIXZhbGlkYXRlKHRpdGxlVmFsaWRhdGFibGUpIHx8XHJcbiAgICAgICAgIXZhbGlkYXRlKGRlc2NyaXB0aW9uVmFsaWRhdGFibGUpIHx8XHJcbiAgICAgICAgIXZhbGlkYXRlKHBlb3BsZVZhbGlkYXRhYmxlKVxyXG4gICAgICAgICkge1xyXG4gICAgICAgIGFsZXJ0KCdJbnZhbGlkIGlucHV0LCBwbGVhc2UgdHJ5IGFnYWluIScpO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHJldHVybiBbZW50ZXJlZFRpdGxlLCBlbnRlcmVkRGVzY3JpcHRpb24sICtlbnRlcmVkUGVvcGxlXTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBjbGVhcklucHV0cygpIHtcclxuICAgICAgICB0aGlzLnRpdGxlSW5wdXRFbGVtZW50LnZhbHVlID0gJyc7XHJcbiAgICAgICAgdGhpcy5kZXNjcmlwdGlvbklucHV0RWxlbWVudC52YWx1ZSA9ICcnO1xyXG4gICAgICAgIHRoaXMucGVvcGxlSW5wdXRFbGVtZW50LnZhbHVlID0gJyc7XHJcbiAgICB9XHJcblxyXG4gICAgICAgIEBhdXRvYmluZFxyXG4gICAgICAgIHByaXZhdGUgc3VibWl0SGFuZGxlcihldmVudDogRXZlbnQpIHtcclxuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgY29uc3QgdXNlcklucHV0ID0gdGhpcy5nYXRoZXJVc2VySW5wdXQoKTtcclxuICAgICAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkodXNlcklucHV0KSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgW3RpdGxlLCBkZXNjLCBwZW9wbGVdID0gdXNlcklucHV0XHJcbiAgICAgICAgICAgICAgICBwcm9qZWN0U3RhdGUuYWRkUHJvamVjdCh0aXRsZSwgZGVzYywgcGVvcGxlKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2xlYXJJbnB1dHMoKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4iLCJpbXBvcnQgeyBDb21wb25lbnQgfSBmcm9tICcuL2Jhc2UtY29tcG9uZW50JztcclxuaW1wb3J0IHsgYXV0b2JpbmQgfSBmcm9tICcuLi9kZWNvcmF0b3JzL2F1dG9iaW5kJztcclxuaW1wb3J0IHsgRHJhZ2dhYmxlIH0gZnJvbSAnLi4vbW9kZWxzL2RyYWctZHJvcCdcclxuaW1wb3J0IHsgUHJvamVjdCB9IGZyb20gJy4uL21vZGVscy9wcm9qZWN0J1xyXG5cclxuICAgIGV4cG9ydCBjbGFzcyBQcm9qZWN0SXRlbSBleHRlbmRzIENvbXBvbmVudDxIVE1MVUxpc3RFbGVtZW50LCBIVE1MRWxlbWVudD4gaW1wbGVtZW50cyBEcmFnZ2FibGV7XHJcbiAgICAgICAgcHJpdmF0ZSBwcm9qZWN0OiBQcm9qZWN0XHJcblxyXG4gICAgICAgIGdldCBwZXJzb25zKCkge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5wcm9qZWN0LnBlb3BsZSA9PT0gMSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuICcxIHBlcnNvbidcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBgJHt0aGlzLnByb2plY3QucGVvcGxlfSBwZXJzb25zYFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdHJ1Y3Rvcihob3N0SWQ6IHN0cmluZywgcHJvamVjdDogUHJvamVjdCkge1xyXG4gICAgICAgICAgICBzdXBlcignc2luZ2xlLXByb2plY3QnLCBob3N0SWQsIGZhbHNlLCBwcm9qZWN0LmlkKVxyXG4gICAgICAgICAgICB0aGlzLnByb2plY3QgPSBwcm9qZWN0XHJcblxyXG4gICAgICAgICAgICB0aGlzLmNvbmZpZ3VyZSgpXHJcbiAgICAgICAgICAgIHRoaXMucmVuZGVyQ29udGVudCgpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBAYXV0b2JpbmRcclxuICAgICAgICBkcmFnU3RhcnRIYW5kbGVyKGV2ZW50OiBEcmFnRXZlbnQpIHtcclxuICAgICAgICAgICAgZXZlbnQuZGF0YVRyYW5zZmVyIS5zZXREYXRhKCd0ZXh0L3BsYWluJywgdGhpcy5wcm9qZWN0LmlkKVxyXG4gICAgICAgICAgICBldmVudC5kYXRhVHJhbnNmZXIhLmVmZmVjdEFsbG93ZWQgPSAnbW92ZSc7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBkcmFnRW5kSGFuZGxlcihfOiBEcmFnRXZlbnQpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ0RyYWdFbmQnKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbmZpZ3VyZSgpIHtcclxuICAgICAgICAgICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2RyYWdzdGFydCcsIHRoaXMuZHJhZ1N0YXJ0SGFuZGxlcilcclxuICAgICAgICAgICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2RyYWdlbmQnLCB0aGlzLmRyYWdFbmRIYW5kbGVyKVxyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICByZW5kZXJDb250ZW50KCkge1xyXG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcignaDInKSEudGV4dENvbnRlbnQgPSB0aGlzLnByb2plY3QudGl0bGU7XHJcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCdoMycpIS50ZXh0Q29udGVudCA9IHRoaXMucGVyc29ucyArICcgYXNzaWduZWQnO1xyXG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcigncCcpIS50ZXh0Q29udGVudCA9IHRoaXMucHJvamVjdC5kZXNjcmlwdGlvbjtcclxuICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuIiwiaW1wb3J0IHtDb21wb25lbnQgfSBmcm9tICcuL2Jhc2UtY29tcG9uZW50JztcclxuaW1wb3J0IHsgYXV0b2JpbmR9IGZyb20gJy4uL2RlY29yYXRvcnMvYXV0b2JpbmQnO1xyXG5pbXBvcnQgeyBQcm9qZWN0SXRlbX0gZnJvbSAnLi9wcm9qZWN0LWl0ZW0nO1xyXG5pbXBvcnQgeyBEcmFnVGFyZ2V0IH0gZnJvbSAnLi4vbW9kZWxzL2RyYWctZHJvcCc7XHJcbmltcG9ydCB7IFByb2plY3QsIFByb2plY3RTdGF0dXMgfSBmcm9tICcuLi9tb2RlbHMvcHJvamVjdCc7XHJcbmltcG9ydCB7cHJvamVjdFN0YXRlfSBmcm9tICcuLi9zdGF0ZS9wcm9qZWN0LXN0YXRlJ1xyXG5cclxuICAgZXhwb3J0IGNsYXNzIFByb2plY3RMaXN0IGV4dGVuZHMgQ29tcG9uZW50PEhUTUxETGlzdEVsZW1lbnQsIEhUTUxFbGVtZW50PiBpbXBsZW1lbnRzIERyYWdUYXJnZXR7XHJcbiAgICAgICAgYXNzaWduZWRQcm9qZWN0czogUHJvamVjdFtdO1xyXG5cclxuICAgICAgICBjb25zdHJ1Y3Rvcihwcml2YXRlIHR5cGU6ICdhY3RpdmUnIHwgJ2ZpbmlzaGVkJykge1xyXG4gICAgICAgICAgICBzdXBlcigncHJvamVjdC1saXN0JywgJ2FwcCcsIGZhbHNlLCBgJHt0eXBlfS1wcm9qZWN0c2ApXHJcbiAgICAgICAgICAgIHRoaXMuYXNzaWduZWRQcm9qZWN0cyA9IFtdXHJcblxyXG4gICAgICAgICAgICB0aGlzLmNvbmZpZ3VyZSgpXHJcbiAgICAgICAgICAgIHRoaXMucmVuZGVyQ29udGVudCgpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBAYXV0b2JpbmRcclxuICAgICAgICBkcmFnT3ZlckhhbmRsZXIoZXZlbnQ6IERyYWdFdmVudCkge1xyXG4gICAgICAgICAgICBpZiAoZXZlbnQuZGF0YVRyYW5zZmVyICYmIGV2ZW50LmRhdGFUcmFuc2Zlci50eXBlc1swXSA9PT0gJ3RleHQvcGxhaW4nKSB7XHJcbiAgICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpXHJcbiAgICAgICAgICAgICAgICBjb25zdCBsaXN0RWwgPSB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcigndWwnKSE7XHJcbiAgICAgICAgICAgICAgICBsaXN0RWwuY2xhc3NMaXN0LmFkZCgnZHJvcHBhYmxlJylcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgQGF1dG9iaW5kXHJcbiAgICAgICAgZHJvcEhhbmRsZXIoZXZlbnQ6IERyYWdFdmVudCkge1xyXG4gICAgICAgICAgICBjb25zdCBwcmpJZCA9IGV2ZW50LmRhdGFUcmFuc2ZlciEuZ2V0RGF0YSgndGV4dC9wbGFpbicpO1xyXG4gICAgICAgICAgICBwcm9qZWN0U3RhdGUubW92ZVByb2plY3QocHJqSWQsIHRoaXMudHlwZSA9PT0gJ2FjdGl2ZScgPyBQcm9qZWN0U3RhdHVzLkFjdGl2ZSA6IFByb2plY3RTdGF0dXMuRmluaXNoZWQpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBAYXV0b2JpbmRcclxuICAgICAgICBkcmFnTGVhdmVIYW5kbGVyKF86IERyYWdFdmVudCkge1xyXG5cclxuICAgICAgICAgICAgY29uc3QgbGlzdEVsID0gdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ3VsJykhO1xyXG4gICAgICAgICAgICBsaXN0RWwuY2xhc3NMaXN0LnJlbW92ZSgnZHJvcHBhYmxlJylcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbmZpZ3VyZSgpIHtcclxuICAgICAgICAgICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2RyYWdvdmVyJywgdGhpcy5kcmFnT3ZlckhhbmRsZXIpO1xyXG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignZHJhZ2xlYXZlJywgdGhpcy5kcmFnTGVhdmVIYW5kbGVyKTtcclxuICAgICAgICAgICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2Ryb3AnLCB0aGlzLmRyb3BIYW5kbGVyKTtcclxuXHJcbiAgICAgICAgICAgIHByb2plY3RTdGF0ZS5hZGRMaXN0ZW5lcigocHJvamVjdHM6IFByb2plY3RbXSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgcmVsZXZhbnRQcm9qZWN0cyA9IHByb2plY3RzLmZpbHRlcihwcmogPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnR5cGUgPT09ICdhY3RpdmUnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwcmouc3RhdHVzID09PSBQcm9qZWN0U3RhdHVzLkFjdGl2ZVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcHJqLnN0YXR1cyA9PT0gUHJvamVjdFN0YXR1cy5GaW5pc2hlZFxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmFzc2lnbmVkUHJvamVjdHMgPSByZWxldmFudFByb2plY3RzXHJcbiAgICAgICAgICAgICAgICB0aGlzLnJlbmRlclByb2plY3RzKCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmVuZGVyQ29udGVudCgpIHtcclxuICAgICAgICAgICAgY29uc3QgbGlzdElkID0gYCR7dGhpcy50eXBlfS1wcm9qZWN0cy1saXN0YDtcclxuICAgICAgICAgICAgdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ3VsJykhLmlkID0gbGlzdElkO1xyXG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcignaDInKSEudGV4dENvbnRlbnQgPSB0aGlzLnR5cGUudG9VcHBlckNhc2UoKSArICcgUFJPSkVDVFMnO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHJpdmF0ZSByZW5kZXJQcm9qZWN0cygpIHtcclxuICAgICAgICAgICAgY29uc3QgbGlzdEVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXHJcbiAgICAgICAgICAgICAgICBgJHt0aGlzLnR5cGV9LXByb2plY3RzLWxpc3RgXHJcbiAgICAgICAgICAgICkhIGFzIEhUTUxVTGlzdEVsZW1lbnRcclxuICAgICAgICAgICAgbGlzdEVsLmlubmVySFRNTCA9ICcnXHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgcHJqSXRlbSBvZiB0aGlzLmFzc2lnbmVkUHJvamVjdHMpIHsgXHJcbiAgICAgICAgICAgICAgICBuZXcgUHJvamVjdEl0ZW0odGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ3VsJykhLmlkLCBwcmpJdGVtKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4iLCJpbXBvcnQgeyBQcm9qZWN0SW5wdXQgfSBmcm9tICcuL2NvbXBvbmVudHMvcHJvamVjdC1pbnB1dCc7XHJcbmltcG9ydCB7IFByb2plY3RMaXN0IH0gZnJvbSAnLi9jb21wb25lbnRzL3Byb2plY3QtbGlzdCc7XHJcblxyXG5uZXcgUHJvamVjdElucHV0KClcclxuXHJcbmNvbnN0IHByb2plY3RMaXN0Q29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2FjdGl2ZS1maW5pc2hlZC1wcm9qZWN0cycpITtcclxuXHJcbmNvbnN0IGFjdGl2ZVByakxpc3QgPSBuZXcgUHJvamVjdExpc3QoJ2FjdGl2ZScpO1xyXG5jb25zdCBmaW5pc2hlZFByakxpc3QgPSBuZXcgUHJvamVjdExpc3QoJ2ZpbmlzaGVkJyk7XHJcblxyXG5wcm9qZWN0TGlzdENvbnRhaW5lci5hcHBlbmRDaGlsZChhY3RpdmVQcmpMaXN0LmVsZW1lbnQpO1xyXG5wcm9qZWN0TGlzdENvbnRhaW5lci5hcHBlbmRDaGlsZChmaW5pc2hlZFByakxpc3QuZWxlbWVudCk7XHJcblxyXG5cclxuXHJcbiJdLCJuYW1lcyI6WyJDb21wb25lbnQiLCJjb25zdHJ1Y3RvciIsInRlbXBsYXRlZElkIiwiaG9zdEVsZW1lbnRJZCIsImluc2VydEF0U3RhcnQiLCJuZXdFbGVtZW50SWQiLCJ0aGlzIiwidGVtcGxhdGVFbGVtZXRuIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsImhvc3RFbGVtZW50IiwiaW1wb3J0ZWROb2RlIiwiaW1wb3J0Tm9kZSIsImNvbnRlbnQiLCJlbGVtZW50IiwiZmlyc3RFbGVtZW50Q2hpbGQiLCJpZCIsImF0dGFjaCIsImluc2VydEF0QmVnaW5uaW5nIiwiaW5zZXJ0QWRqYWNlbnRFbGVtZW50IiwiYXV0b2JpbmQiLCJfIiwiXzIiLCJkZXNjcmlwdG9yIiwib3JpZ2luYWxNZXRob2QiLCJ2YWx1ZSIsImNvbmZpZ3VyYWJsZSIsImdldCIsImJpbmQiLCJ2YWxpZGF0ZSIsInZhbGlkYXRhYmxlSW5wdXQiLCJpc1ZhbGlkIiwicmVxdWlyZWQiLCJ0b1N0cmluZyIsInRyaW0iLCJsZW5ndGgiLCJtaW5MZW5ndGgiLCJtYXhMZW5ndGgiLCJtaW4iLCJtYXgiLCJQcm9qZWN0U3RhdHVzIiwiUHJvamVjdCIsInRpdGxlIiwiZGVzY3JpcHRpb24iLCJwZW9wbGUiLCJzdGF0dXMiLCJTdGF0ZSIsImxpc3RlbmVycyIsImFkZExpc3RlbmVyIiwibGlzdGVuZXJGbiIsInB1c2giLCJQcm9qZWN0U3RhdGUiLCJzdXBlciIsInByb2plY3RzIiwiZ2V0SW5zdGFuY2UiLCJpbnN0YW5jZSIsImFkZFByb2plY3QiLCJudW1PZlBlb3BsZSIsIm5ld1Byb2plY3QiLCJNYXRoIiwicmFuZG9tIiwiQWN0aXZlIiwidXBkYXRlTGlzdGVuZXJzIiwibW92ZVByb2plY3QiLCJwcm9qZWN0SWQiLCJuZXdTdGF0dXMiLCJwcm9qZWN0IiwiZmluZCIsInByaiIsInNsaWNlIiwicHJvamVjdFN0YXRlIiwiUHJvamVjdElucHV0IiwidGl0bGVJbnB1dEVsZW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiZGVzY3JpcHRpb25JbnB1dEVsZW1lbnQiLCJwZW9wbGVJbnB1dEVsZW1lbnQiLCJjb25maWd1cmUiLCJhZGRFdmVudExpc3RlbmVyIiwic3VibWl0SGFuZGxlciIsInJlbmRlckNvbnRlbnQiLCJnYXRoZXJVc2VySW5wdXQiLCJlbnRlcmVkVGl0bGUiLCJlbnRlcmVkRGVzY3JpcHRpb24iLCJlbnRlcmVkUGVvcGxlIiwiZGVzY3JpcHRpb25WYWxpZGF0YWJsZSIsInBlb3BsZVZhbGlkYXRhYmxlIiwiYWxlcnQiLCJjbGVhcklucHV0cyIsImV2ZW50IiwicHJldmVudERlZmF1bHQiLCJ1c2VySW5wdXQiLCJBcnJheSIsImlzQXJyYXkiLCJkZXNjIiwiUHJvamVjdEl0ZW0iLCJwZXJzb25zIiwiaG9zdElkIiwiZHJhZ1N0YXJ0SGFuZGxlciIsImRhdGFUcmFuc2ZlciIsInNldERhdGEiLCJlZmZlY3RBbGxvd2VkIiwiZHJhZ0VuZEhhbmRsZXIiLCJjb25zb2xlIiwibG9nIiwidGV4dENvbnRlbnQiLCJQcm9qZWN0TGlzdCIsInR5cGUiLCJhc3NpZ25lZFByb2plY3RzIiwiZHJhZ092ZXJIYW5kbGVyIiwidHlwZXMiLCJjbGFzc0xpc3QiLCJhZGQiLCJkcm9wSGFuZGxlciIsInByaklkIiwiZ2V0RGF0YSIsIkZpbmlzaGVkIiwiZHJhZ0xlYXZlSGFuZGxlciIsInJlbW92ZSIsInJlbGV2YW50UHJvamVjdHMiLCJmaWx0ZXIiLCJyZW5kZXJQcm9qZWN0cyIsImxpc3RJZCIsInRvVXBwZXJDYXNlIiwiaW5uZXJIVE1MIiwicHJqSXRlbSIsInByb2plY3RMaXN0Q29udGFpbmVyIiwiYWN0aXZlUHJqTGlzdCIsImZpbmlzaGVkUHJqTGlzdCIsImFwcGVuZENoaWxkIl0sInNvdXJjZVJvb3QiOiIifQ==